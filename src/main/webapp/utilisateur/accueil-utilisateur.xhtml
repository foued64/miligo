<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/WEB-INF/templates/template-standard-utilisateur.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:cps="http://java.sun.com/jsf/composite/composites">

	<ui:define name="title">Accueil - Utilisateur</ui:define>
	<ui:define name="content">
		<ui:include
			src="/WEB-INF/templates/fragments/fragment-infouser-deconnect.xhtml" />
		
		
		
		<div class="pageMobile">
              <h:form>                         
				<p:commandButton class="btnMobile" value="Emprunter"
                                      actionListener="#{accueilBeans.entrerEmprunt()}" 
                                      onerror="#{accueilBeans.checkVehiculesDispoBorneOnError()}"/>

				<p:commandButton class="btnMobile" value="Restituer"
                                      actionListener="#{accueilBeans.entrerRestitutionVehicule()}"/>                                      
  
               <p:commandButton class="btnMobile" value="Reserver"
                                     action="reserver-vehicule.xhtml?faces-redirect=true"/>                                      
  
                              
              </h:form>
		</div>
		
		<p:messages id="messages" showIcon="false" showDetail="false" autoUpdate="true" closable="true" />		
		
		
		<hr />

		

		<!-- Ici le tableau récapitulatif des réservations -->
		
		<h:form>
		    <!-- Rafraichit le dataTable toutes les 5 min (300 secondes) -->
			<p:poll interval="300" listener="#{accueilBeans.chargerListeReservations()}"  update="dtReservations" />

			<p:dataTable id="dtReservations" var="r" value="#{accueilBeans.listeReservations}" emptyMessage="Vous n'avez aucune réservation">
				<p:column headerText="Liste des réservations">
					<h:outputText value="#{r.numeroReservation}" />
				</p:column>
	
				<p:column headerText="Départ -Arrivée">
					<h:outputText value="#{r.trajet.borneDepart.site.nom} -> #{r.trajet.borneArrivee.site.nom}" />
				</p:column>
	
				<p:column headerText="Date de la réservation">
					<cps:outputDateTime  pattern="dd/MM/yyyy HH:mm" type="datetime" value="#{r.dateReservation}"/>
				</p:column>
	
				<p:column headerText="Action">
					<p:commandButton value="Emprunter" disabled="true"/>
				</p:column>
			</p:dataTable>
		</h:form>

	</ui:define>

</ui:composition>